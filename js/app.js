function onScroll(){clearInterval(dancing),danceTimer&&(resetFancyPants(),clearTimeout(danceTimer)),danceTimer=setTimeout(function(){dancing=setInterval(dance,500)},danceDelay);var a=window.scrollX-prevScrollX>0;prevScrollX=window.scrollX,a?(skate("front"),moveHair(-10),lookLeft()):(skate("back"),moveHair(10),lookRight()),scrollTimer&&clearTimeout(scrollTimer),scrollTimer=setTimeout(function(){moveHair(0),eat(),scrollContent(window.pageXOffset)},1),lookTimer&&clearTimeout(lookTimer),lookTimer=setTimeout(lookStraight,100)}function scrollContent(a){var b=Math.floor(a/windowWidth)+1;for(i in listItems)listItems[i].className="";document.querySelector(".story li:nth-child("+b+")").className="active"}function skate(a){wheels.forEach(function(b){ang="front"==a?ang+1:ang-1,b.transform("r"+[10*ang])})}function moveHair(a){hair.animate({transform:"r"+[a,pivots.hair]},10)}function eat(){for(var a=foodPoints.length-1;a>=0;a--){var b=foodPoints[a];window.scrollX>b.el.node.offsetLeft-330&&!b.isEaten&&openMouth(),window.scrollX>b.el.node.offsetLeft-150&&!b.isEaten&&(b.el.node.style.display="none",closeMouth(),changePants(b.el.node.getAttribute("color")),b.isEaten=!0)}}function blinkEyes(){eyes.forEach(function(a){a.attr({r:0})}),setTimeout(function(){eyes.forEach(function(a){a.attr({r:4.08})})},100)}function changePants(a){pants.forEach(function(b){b.animate({fill:a},200)})}function lookLeft(){eyes.forEach(function(a){a.animate({transform:"t"+[10,0]},50)})}function lookRight(){eyes.forEach(function(a){a.animate({transform:"t"+[-10,0]},50)})}function openMouth(){smile.attr("display","none"),mouth.attr("display","inline").animate({transform:"t"+[-26,0]},20)}function closeMouth(){smile.attr("display","inline"),mouth.attr("display","none").animate({transform:"t"+[0,0]},20)}function lookStraight(){eyes.forEach(function(a){a.animate({transform:"t"+[0,0]},50)})}function moveClouds(){setInterval(function(){cloud.transform("t"+[i++,0])},200)}function dance(){pant1.animate({transform:"t"+[-7,0]},200),pant2.animate({transform:"t"+[-7,0]},200),spine.animate({transform:"r"+[5,pivots.spine]},200),legCrack.animate({transform:"t"+[-7,0]+"r"+[-10,pivots.folds]},200),leftFolds.animate({transform:"t"+[-7,0]+"r"+[-10,pivots.folds]},200),rightFolds.animate({transform:"t"+[-7,0]+"r"+[-10,pivots.folds]},200),hand1.animate({transform:"r"+[-7,pivots.spine]},200),hand2.animate({transform:"r"+[-7,pivots.spine]},200),belt.animate({transform:"t"+[-7,0]},200),setTimeout(function(){pant1.animate({transform:"t"+[7,0]},200),pant2.animate({transform:"t"+[7,0]},200),spine.animate({transform:"r"+[-5,pivots.spine]},200),legCrack.animate({transform:"t"+[7,0]+"r"+[15,pivots.folds]},200),leftFolds.animate({transform:"t"+[7,0]+"r"+[15,pivots.folds]},200),rightFolds.animate({transform:"t"+[7,0]+"r"+[15,pivots.folds]},200),hand1.animate({transform:"r"+[7,pivots.spine]},200),hand2.animate({transform:"r"+[7,pivots.spine]},200),belt.animate({transform:"t"+[7,0]},200)},250)}function resetFancyPants(){pant1.animate({transform:"t"+[0,0]},200),pant2.animate({transform:"t"+[0,0]},200),spine.animate({transform:"r"+[0,pivots.spine]},200),legCrack.animate({transform:"t"+[0,0]+"r"+[0,pivots.folds]},200),leftFolds.animate({transform:"t"+[0,0]+"r"+[0,pivots.folds]},200),rightFolds.animate({transform:"t"+[0,0]+"r"+[0,pivots.folds]},200),hand1.animate({transform:"r"+[0,pivots.spine]},200),hand2.animate({transform:"r"+[0,pivots.spine]},200),belt.animate({transform:"t"+[0,0]},200)}var k=!1,j=!1,i=0,ang=0,looking=null,scrollTimer=null,danceTimer=null,lookTimer=null,dancing=null,danceDelay=5e3,prevScrollX=0,foodPoints=[],windowWidth=window.outerWidth,cloud=Snap.select(".cloud"),fancypants=Snap.select(".fp"),hair=Snap.select("#Hair"),head=Snap.select("#Face"),eyes=Snap.selectAll("#Right_eye,#Left_eye"),smile=Snap.select("#Smile"),mouth=Snap.select("#Open_mouth_1_"),spine=Snap.select("#Spine"),hand1=Snap.select("#Left_hand"),hand2=Snap.select("#Right_hand"),belt=Snap.select("#Belt_1_"),pant1=Snap.select("#Left_leg"),pant2=Snap.select("#Right_leg"),wheels=Snap.selectAll("#wheel,#wheel_1_"),legCrack=Snap.select("#Leg_crack"),leftFolds=Snap.select("#Left_pant_folds"),rightFolds=Snap.select("#Right_pant_folds"),pants=Snap.selectAll("#Right_leg,#Left_leg"),wheels=Snap.selectAll("#wheel,#wheel_1_"),eatables=Snap.selectAll(".eatable"),pivots={spine:[spine.attr("x1"),spine.attr("y1")],hand1:[hand1.attr("x1"),hand1.attr("y1")],hand2:[hand2.attr("x1"),hand2.attr("y1")],hair:[head.attr("cx"),head.attr("cy")],folds:[legCrack.attr("x2"),legCrack.attr("y2")]},init=function(){eatables.forEach(function(a){var b={el:a,isEaten:!1};foodPoints.push(b)}),setTimeout(function(){lookLeft(),initSKate=setInterval(function(){skate("front")},20),fancypants.attr("class","fp"),setTimeout(function(){clearTimeout(initSKate),lookStraight(),setTimeout(blinkEyes,1e3)},1500)},1e3),document.addEventListener("scroll",function(a){a.preventDefault(),onScroll()}),danceTimer=setTimeout(function(){dancing=setInterval(dance,500)},danceDelay)};window.addEventListener("load",init,!1);var listItems=document.querySelectorAll(".story li");